#!/bin/bash

set -euo pipefail

THEMES_DIR="$HOME/.config/themes"

mapfile -t themes < <(find "$THEMES_DIR" -mindepth 1 -maxdepth 1 -type d -printf "%f\n" | sort)

if (( ${#themes[@]:-0} == 0 )); then
  notify-send "No themes found" "$THEMES_DIR" -t 2000 2>/dev/null || true
  exit 0
fi

if command -v rofi >/dev/null 2>&1; then
  selection=$(printf '%s\n' "${themes[@]}" | rofi -dmenu -i -p "Theme" || true)
else
  # Fallback to simple PS3 select if rofi is missing
  echo "Select theme:" >&2
  PS3="> "
  select t in "${themes[@]}"; do
    selection="$t"; break
  done
fi

if [[ -n "$selection" ]]; then
  "$HOME/.config/hypr/scripts/theme-set" "$selection"
fi


