#!/usr/bin/env bash
set -euo pipefail

have() { command -v "$1" >/dev/null 2>&1; }

is_enabled() {
  hyprctl monitors | grep -q "Monitor $1"
}

toggle() {
  local name="eDP-1"
  if is_enabled "$name"; then
    hyprctl keyword monitor "$name,disable"
  else
    hyprctl keyword monitor "$name,1920x1080@60,1920x0,1"
  fi
  have "$HOME/.config/hypr/scripts/wallpaper" && "$HOME/.config/hypr/scripts/wallpaper" sync >/dev/null 2>&1 || true
}

enable() {
  local name="$1"
  local res="${2:-1920x1080@60}"
  local pos="${3:-0x0}"
  hyprctl keyword monitor "$name,$res,$pos,1"
  have "$HOME/.config/hypr/scripts/wallpaper" && "$HOME/.config/hypr/scripts/wallpaper" sync >/dev/null 2>&1 || true
}

disable() {
  local name="$1"
  hyprctl keyword monitor "$name,disable"
}

case "${1:-}" in
  toggle)  toggle ;;
  enable)  enable "${2:?name}" "${3:-}" "${4:-}" ;;
  disable) disable "${2:?name}" ;;
  *)       echo "usage: $0 {toggle|enable <name> [res] [pos]|disable <name>}"; exit 1 ;;
esac
